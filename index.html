<!doctype html>

<html lang="en">

<head>
  <meta charset="utf-8">

  <title>Tiger Conservation</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" />
  <link href="https://api.mapbox.com/mapbox-assembly/v0.21.2/assembly.min.css" rel="stylesheet">
  <link href='https://api.mapbox.com/mapbox.js/v3.1.1/mapbox.css' rel='stylesheet' />
  <style>
    body,
    #map {
      position: absolute;
      width: 100%;
      top: 0;
      bottom: 0;
      margin: 0;
      padding: 0;
      background: rgba(0, 0, 0, .75);
      z-index: -1;
    }
  </style>

</head>



<body>

  <div class='viewport-full relative scroll-hidden'>
    <div class='bg-darken10 viewport-twothirds viewport-full-ml absolute top left right bottom'></div>
    <div class='absolute top-ml left bottom z1 w-full w360-ml px12 py12-ml'>
      <div class='flex-parent flex-parent--column viewport-third h-auto-ml hmax-full bg-white round-ml shadow-darken10'>
        <div class='px12 py12 scroll-auto'>
          <h2 class='txt-l txt-bold mb6'>The Rani of the Jungle</h2>
          <p>The Royal Bengal Tiger (Panthera tigris tigris) is nearing the end of its reign in Southeast Asia. The species is listed as Endangered on the IUCN Red List and is threatened by poaching, loss and fragmentation of habitat. None of the tiger conservation landscapes within its range is considered large enough to support an effective tiger population of more than 250 adult tigers.</p>
          <br>
          <h2 class='txt-m txt-bold mb6'><div style="display: inline-block; vertical-align: middle"><svg class='icon'><use xlink:href='#icon-layers'/></svg></div>Legend</h2>
          <ul>
            <li class='color-green'><div style="display: inline-block; vertical-align: middle"><svg class='icon'><use xlink:href='#icon-polygon'/></svg></div>Protected Wildlife Areas</li>
            <li class='color-yellow'><div style="display: inline-block; vertical-align: middle"><svg class='icon'><use xlink:href='#icon-polygon'/></svg></div>Tiger Conservation Areas</li>
            <li class='color-red'><div style="display: inline-block; vertical-align: middle"><svg class='icon'><use xlink:href='#icon-polygon'/></svg></div>Tiger Conservation High Priority</li>
          </ul>

        </div>
        <footer class='px12 py12 bg-gray-faint round-b-ml txt-s'>
          <ul>
            <li>Data Sources:
              <a class='link' href='https://www.protectedplanet.net/country/IN'>Protected Planet</a>,   <a class='link' href='http://data.globalforestwatch.org/datasets'>Global Forest Watch</a>.
            </li>
            <br>
            <li>Map authored by
              <p> Marissa Defratti & Maria Renee </p>
            </li>
          </ul>
        </footer>
      </div>
    </div>
  </div>

  <div id="map"></div>


  <!--Load JS Scripts-->
  <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script async defer src="https://api.mapbox.com/mapbox-assembly/v0.21.2/assembly.js"></script>

  <!--Custom JS-->
  <script>
    var options = {
      center: [21.7679, 78.8718],
      zoom: 5,
      minZoom: 2,
      maxZoom: 12,
      maxBounds: [
        [21.7779, 78.8618],
        [21.7579, 78.8718]
      ],
      zoomControl: false
    };
    var map = L.map('map', options);

    L.control.zoom({ position:'topright', scrollWheelZoom: true, doubleClickZoom: true,}).addTo(map);

    //Basemap
    L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
      subdomains: 'abcd',
      maxZoom: 19
    }).addTo(map);

    //Loading data layers
    $.when(
      $.getJSON('Data/india-states.json'),
      $.getJSON('Data/wildlife-areas.json'),
      $.getJSON('Data/conservation-areas.json'),
      $.getJSON('Data/conservation-focus.json'),
    ).done(function(indiaStates, wildlifeAreas, conservationAreas, conservationFocus) {
      drawMap(indiaStates, wildlifeAreas, conservationAreas, conservationFocus);
    });

    function drawMap(indiaStatesData, wildlifeAreasData, conservationAreasData, conservationFocusData) {
      L.geoJson(indiaStatesData, {
        style: statesOptions
      }).addTo(map);

      L.geoJson(wildlifeAreasData, {
        style: wildlifeOptions,
        onEachFeature: function(feature, layer) {
            // shortut to variable
            var tooltip = feature.properties.NAME;
            // bind the tooltip to the layer
            layer.bindTooltip(tooltip, {
                sticky: true,
                className: 'tooltip'
            });
            // visual affordance on mouseover
            layer.on('mouseover', function(e) {
                this.setStyle({
                    weight: 1
                });
            });
            // use existing option to reset the styles on mouseout
            layer.on('mouseout', function(e) {
                this.setStyle(wildlifeOptions);
            });
        }
      }).addTo(map);

      L.geoJson(conservationAreasData, {
        style: conAreasOptions,
        onEachFeature: function(feature, layer) {
            // shortut to variable
            var tooltip = feature.properties.tcl_name;
            // bind the tooltip to the layer
            layer.bindTooltip(tooltip, {
                sticky: true,
                className: 'tooltip'
            });
            // visual affordance on mouseover
            layer.on('mouseover', function(e) {
                this.setStyle({
                    weight: 1
                });
            });
            // use existing option to reset the styles on mouseout
            layer.on('mouseout', function(e) {
                this.setStyle(conAreasOptions);
            });
        }
      }).addTo(map);

      L.geoJson(conservationFocusData, {
        style: conFocusOptions,
        onEachFeature: function(feature, layer) {
            // shortut to variable
            var tooltip = feature.properties.tcl_name;
            // bind the tooltip to the layer
            layer.bindTooltip(tooltip, {
                sticky: true,
                className: 'tooltip'
            });
            // visual affordance on mouseover
            layer.on('mouseover', function(e) {
                this.setStyle({
                    weight: 1
                });
            });
            // use existing option to reset the styles on mouseout
            layer.on('mouseout', function(e) {
                this.setStyle(conFocusOptions);
            });
        }
      }).addTo(map);
    }

    // Layer styles
    var statesOptions = {
      color: '#3B332C',
      weight: 0.3,
      fill: false
    }

    var conAreasOptions = {
      color: '#F3CF1E',
      weight: 0.5,
      fillOpacity: 0.7
    }

    var conFocusOptions = {
      color: '#A14A37',
      weight: 0.5,
      fillOpacity: 0.9
    }

    var wildlifeOptions = {
      color: '#3B9B82',
      weight: 0.5,
      fillOpacity: 0.5
    }


  </script>
</body>

</html>
